---
layout: post
title:  "Cve-2017-11882"
date:   2019-09-27 20:35:00
tags: Cve
color: "#FFF68F"
cover: '../../assets/test.png'
subtitle: 'cve-2017-11882'
---

#CVE-2017-11882

##0x00概述
此漏洞是由Office软件里面的[EQNEDT32.EXE 公式编辑器] 造成的，进程在读入包含MathType的ole数据时，在拷贝公式字体名称（Font Name数据）时没有对名称长度进行校验，导致缓冲区溢出。攻击者通过构造特殊的字符，覆盖函数的返回地址,可以实现任意代码执行。
##0x01Poc生成
https://github.com/Ridter/CVE-2017-11882
（1）43b 
python Command43b_CVE-2017-11882.py -c "cmd.exe /c calc.exe" -o test.doc

（2）109b
python Command109b_CVE-2017-11882.py -c "cmd.exe /c calc.exe" -o test.doc
##0x02调试过程
（1）Bp WinExec
 
图1函数调用WinExec栈情况
（2）栈回溯到上一层函数
 
图2第一层函数调用
（3）观察栈情况单步执行，直到栈中出现图1 
 
图3第二层函数调用
（4）单步执行观察栈情况，直到到复制函数
 
图4复制过程中栈的变化
 
图5漏洞溢出点
（5）根据溢出点定位文件函数41160F
 
图6调试过程中的所有断点
 
图7静态找出漏洞位置

##0x03poc原理分析
